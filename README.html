<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
         "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>multispoof</title>
		<style type="text/css">
      a
      {
        color: red;
      }
      p,li,h2
      {
        font-family: sans-serif;
      }
      h2
      {
        font-size: 20px;
      }
      p
      {
        font-size: 15px;
      }
      li
      {
        font-size: 14px;
      }
      body
      {
        padding-left: 70px;
        padding-right: 20%;
      }
		</style>
	</head>
	<body>
		<h2>multispoof</h2>
		<h3>Parallel spoofing for throughput increase</h3>
		<h4>What is
      <a href="http://multispoof.cryptonix.org/">multispoof</a>?</h4>
    <p>
      Multispoof is an application, which exploits weak, address based
      authentication very frequently implemented by ISPs in Ethernet
      networks. 
      In such networks customers are identified with IP-MAC address
      pairs, and only those paying ISP are granted access to the
      Internet.
    </p>
    <p>
      Multispoof uses IP and MAC spoofing
      to impersonate legitimate customers. The idea is not new,
      but multispoof does it in a smart way. As it impersonates only
      inactive customers, there is no address conflicts. And
      using multiple addresses in parallel in combination with
      load balancing allows to achieve much higher transfer rates.
    </p>
    <p>
      It could be compared with download accelerating software,
      because higher throughput is achieved with multiple
      transmissions. The difference is that multispoof operates on
      layers 2 and 3 of the OSI model. In contrast, download accelerator
      uses multiple TCP streams &ndash; the fourth layer of OSI model.
    </p>
    <p>
      I've created multispoof as a software project for my M.Sc. thesis,
      so entire application (version 0.6.1) is documented quite
      precisely in there.
      If you read Polish, you can get my thesis in papers
      section on <a href="http://cryptonix.org/">my page</a>.
      I've spent entire chapter on spoofing detection and prevention
      techniques, so if you are ISP, you may be interested too.
    </p>
    <h4>Legal</h4>
    <p>
      Multispoof was created to demonstrate the risk of using weak
      authentication methods, and is meant to be used for testing
      purposes. It is only a tool and you are responsible for its usage,
      especially for abuse of your ISP network.
    </p>
		<h4>Features</h4>
		<ul>
			<li>Accelerates throughput multiple times using parallel
          spoofing with load balancing.</li>
      <li>When aggresively used can fill up your ISP Internet
          link, so its great for testing maximal throughput
          of provider :)</li>
      <li>IP and MAC spoofing.</li>
			<li>Only inactive addresses are used for spoofing. No address
          conflicts.</li>
			<li>Detection of active hosts performed with ARP scanning.</li>
			<li>Only addresses permitted to access external network
          (usually Internet) are used in spoofing process. Connectivity
          testing is easily configurable.</li>
		</ul>
		<h4>Download</h4>
		<p>
      The multispoof source code is released
      under <a href="http://www.gnu.org/licenses/gpl.html">GPLv2</a>
      license and can be downloaded from
      sourceforge
<a href="https://sourceforge.net/projects/multispoof/">project page</a>.
		</p>
    <p>
      Version history can be found in Changelog file in tarball.
    </p>
    <h4>Requirements</h4>
    <p>
      In order to run multispoof you need:
  		<ul>
			  <li>
          <a href="http://www.kernel.org/">Linux</a> kernel with
          following features enabled:
            <ul>
              <li>Tun/tap wirtual network interfaces.</li>
              <li>Unix sockets.</li>
              <li>Netfilter with SNAT and DNAT targets, nth and owner
                  matches (nth is in <a href="http://www.netfilter.org/patch-o-matic/">patch-o-matic</a> package).</li>
            </ul>
			  </li>
        <li>Ip tool from
          <a href="http://developer.osdl.org/dev/iproute2/">iproute2</a>
          suite.</li>
        <li><a
          href="http://www.gnu.org/software/bash/bash.html">Bash</a>
          (only version 3.0 tested).</li>
        <li><a href="http://www.tcpdump.org/">Libpcap</a> 0.9.3 or
            higher.</li>
        <li><a href="http://www.packetfactory.net/libnet/">Libnet</a>
            (only 1.1.2.1 tested, although other versions
            should also work).</li>
        <li><a href="http://www.gtk.org/">GLib</a> 2.6 or higher.</li>
        <li><a href="http://www.insecure.org/nmap/">Nmap</a>
          (only 3.81 version tested, but other versions should
          also work)</li>
        <li>Standard unix text tools.</li>
      </ul>
      Compilation process requires also:
      <ul>
			  <li>C compiler (<a href="http://gcc.gnu.org/">gcc</a> 3.3.5
          was tested).</li>
			  <li>Header files for glib, libnet and libpcap libraries.</li>
			  <li>Linux kernel headers (for tun/tap). They need to match
            the running kernel, otherwise strange things can happen.
        </li>
			  <li>Make tool
     (<a href="http://www.gnu.org/software/make/make.html">GNU Make</a>
     3.80 was tested).</li>
			  <li><a
          href="http://pkgconfig.freedesktop.org/wiki/">Pkg-config</a>
          tool (version 0.15.0 was tested).</li>
			  <li>Install tool, part of
          <a href="http://www.gnu.org/software/coreutils/">coreutils</a>
          (version 5.2.1 was tested).
        </li>
		  </ul>
    </p>
    <h4>Compilation and installation</h4>
    <p>
      You are advised to check multispoof tarball integrity against
      my gpg key, which can be downloaded
      from <a href="https://secure.cryptonix.org/">here</a>.
      If the tarball and signature are in current working directory,
      issue:
      <pre>
   $ gpg --verify multispoof-*.tar.gz.asc
      </pre>
      After positive verification, you can extract multispoof source
      distribution with:
      <pre>
   $ tar zxf multispoof-*.tar.gz
      </pre>
      Then enter newly created directory, optionally alter instalation
      paths at the beginning of Makefile, and execute:
      <pre>
   $ make
      </pre>
      After successful compilation, issue:
      <pre>
   $ su -c "make install"
      </pre>
      Note that the installation is required for program to run
      correctly. You can uninstall it with:
      <pre>
   $ su -c "make uninstall"
      </pre>
    </p>
    <h4>Usage</h4>
    <p>
      Multispoof requires root provileges. Before running it you should
      kill DHCP client. Multispoof removes IP address from the
      network interface (it is reassigned on program termination).
      While operating, program requires no IP address set on network
      interface. The DHCP client could assign it, which is not
      desirable &ndash; and that's why it should be killed.
      Also, if you don't want to be caught easily by
      network administrator, you should change your IP and MAC
      addresses, because they are used for scanning.
    </p>
    <p>
      Passing -h option to multispoof makes it show usage information.
      To launch the program and instruct it to use eth0 interface,
      invoke:
      <pre>
   # multispoof -i eth0
      </pre>
      If everything is ok, you should see something like this:
      <pre>
   netdb: Listening on /tmp/multispoof.XX410BZG/socket
   rx (tapio): listening on eth0
   rx (deta): listening on eth0
   tapio: virtual interface: tap0
   tx (tapio): using device eth0
   tx (deta): using device eth0
   tx (scanarp): using device eth0
   cmac (unspoof): Using be:70:8d:4d:6a:a9 as default mac
      </pre>
    </p>
    <p>
      After first run, multispoof starts learning network
      addresses and save them to its database file. This file
      is reused on consecutive runs, so gathered addresses are not
      lost after program termination.
      Multispoof uses only inactive addresses for spoofing,
      so it's best to leave it running for some time (for example
      one night). After that database should be filled
      with enough addresses, and hopefully some of them will be
      inactive.
      Remember, that multispoof's default behavior is waiting for
      5 minutes before inactive address is to be used.
      So after launching of the program, there is at least that
      delay before Internet connection could be used.
    </p>
    <p>
      Now launch your favorite p2p program or download accelerator
      and get some data really fast :) <b>The more file chunks are
      downloaded in parallel, the higher throughput you get.</b>
    </p>
    <h4>Internal state monitoring</h4>
    <p>
      Collected addresses can be listed by connecting to multispoof
      address database through unix socket. The
      <a href="http://www.dest-unreach.org/socat/">socat</a> tool can
      be helpfull:
      <pre>
   # socat /tmp/multispoof.XXtIpgfL/socket -
   +OK Welcome
   dump
   192.168.1.23
   192.168.1.42
   192.168.1.69
   192.168.1.47
   +OK Dump complete
   quit
   +OK Bye
      </pre>
    </p>
    <p>
      Addresses currently used for spoofing can be displayed with
      command:
      <pre>
   # iptables -t nat -nL multispoof-sub
   Chain multispoof-sub (1 references)
   target     prot opt source               destination         
   SNAT       all  --  0.0.0.0/0            0.0.0.0/0 \
   every 2th packet #0 to:192.168.1.23 
   SNAT       all  --  0.0.0.0/0            0.0.0.0/0 \
   every 2th packet #1 to:192.168.1.42 
      </pre>
    </p>
    <p>
      To check if load balancing works correctly, you can run ping
      and use tcpdump to sniff its traffic:
      <pre>
   # tcpdump -eni eth0 icmp
   tcpdump: WARNING: eth0: no IPv4 address assigned
   tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
   listening on eth0, link-type EN10MB (Ethernet), capture size 96 bytes
   23:21:27.997833 00:20:ed:b6:78:43 &gt; 00:20:af:c4:6f:e3, ethertype IPv4 \
    (0x0800), length 98: IP 192.168.1.23 &gt; 212.77.100.101: icmp 64: \
    echo request seq 1
   23:21:28.039748 00:20:af:c4:6f:e3 &gt; 00:20:ed:b6:78:43, ethertype IPv4 \
    (0x0800), length 98: IP 212.77.100.101 &gt; 192.168.1.23: icmp 64: \
    echo reply seq 1
   23:21:28.992051 00:02:44:7b:09:11 &gt; 00:20:af:c4:6f:e3, ethertype IPv4 \
    (0x0800), length 98: IP 192.168.1.42 &gt; 212.77.100.101: icmp 64: \
    echo request seq 2
   23:21:29.036361 00:20:af:c4:6f:e3 &gt; 00:02:44:7b:09:11, ethertype IPv4 \
    (0x0800), length 98: IP 212.77.100.101 &gt; 192.168.1.42: icmp 64: \
    echo reply seq 2
   23:21:29.992307 00:20:ed:b6:78:43 &gt; 00:20:af:c4:6f:e3, ethertype IPv4 \
    (0x0800), length 98: IP 192.168.1.23 &gt; 212.77.100.101: icmp 64: \
    echo request seq 3
   23:21:30.046712 00:20:af:c4:6f:e3 &gt; 00:20:ed:b6:78:43, ethertype IPv4 \
    (0x0800), length 98: IP 212.77.100.101 &gt; 192.168.1.23: icmp 64: \
    echo reply seq 3
   23:21:30.994180 00:02:44:7b:09:11 &gt; 00:20:af:c4:6f:e3, ethertype IPv4 \
    (0x0800), length 98: IP 192.168.1.42 &gt; 212.77.100.101: icmp 64: \
    echo request seq 4
   23:21:31.098238 00:20:af:c4:6f:e3 &gt; 00:02:44:7b:09:11, ethertype IPv4 \
    (0x0800), length 98: IP 212.77.100.101 &gt; 192.168.1.42: icmp 64: \
    echo reply seq 4
      </pre>
    </p>
		<h4>Author, contact</h4>
		<p>
      This software was written by me, Paweł Pokrywka.
			You can find my email address as well as my gpg key at:<br />
      <a
  href="https://secure.cryptonix.org/">https://secure.cryptonix.org/</a>
		</p>
    <p>
      <a href="http://sourceforge.net"><img src="http://sourceforge.net/sflogo.php?group_id=144134&amp;type=1" width="88" height="31" border="0" alt="This project is hosted on SourceForge.net." /></a>
    </p>
	</body>
</html>
